<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ _('Diabetes Prediction') }} | {{ _('Diabetes Care') }}</title>
  <link rel="icon" href="{{ url_for('static', filename='stethoscope.png') }}" type="image/png">
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ _('Diabetes Prediction') }} | {{ _('Diabetes Care') }}</title>
    <link
      rel="icon"
      href="{{ url_for('static', filename='stethoscope.png') }}"
      type="image/png"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = { darkMode: "class" };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script>
      (function () {
        var savedTheme = localStorage.getItem("theme");
        var prefersDark = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;
        if (savedTheme === "dark" || (!savedTheme && prefersDark)) {
          document.documentElement.classList.add("dark");
        }
      })();
    </script>
    <style>
      * {
        transition: background-color 0.3s ease, border-color 0.3s ease;
      }
      .glass-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }
      .dark .glass-card {
        background: rgba(30, 41, 59, 0.95);
        border: 1px solid rgba(148, 163, 184, 0.2);
      }
      .fade-in {
        animation: fadeIn 0.6s ease-out forwards;
        opacity: 0;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .theme-toggle:hover {
        transform: rotate(15deg) scale(1.1);
      }
      .input-field:focus {
        transform: scale(1.01);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
      }
      @media print {
        body > *:not(#printableReport) {
          display: none !important;
        }

        #printableReport {
          display: block !important;
          position: static !important;
          height: auto !important;
          min-height: auto !important;
          page-break-after: avoid !important;
        }

        html,
        body {
          height: auto !important;
          overflow: visible !important;
        }
      }
       .scroll-to-top {
            position: fixed;
             bottom: 30px;
                right: 30px;
                width: 50px;
                height: 50px;
                background: #8b5cf6;
                color: #fff;
                border: none;
                border-radius: 50%;
                cursor: pointer;
                display: none;
                align-items: center;
                justify-content: center;
                font-size: 1.2rem;
                box-shadow: 0 4px 15px rgba(56, 189, 248, 0.4);
                transition: all 0.3s ease;
                z-index: 1000;
            }

            .scroll-to-top:hover {
                transform: translateY(-5px);
                box-shadow: 0 6px 20px rgba(56, 189, 248, 0.6);
            }

            .scroll-to-top.show {
                display: flex;
            }
    </style>
  </head>

  <body
    class="min-h-screen bg-gray-50 dark:bg-slate-950 transition-colors duration-300"
  >
    <!-- Navbar -->
    <nav
      class="bg-gradient-to-r from-blue-600 to-indigo-700 dark:from-slate-800 dark:to-slate-900 text-white shadow-lg sticky top-0 z-50"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <a href="/" class="flex items-center gap-2">
            <span class="text-2xl">‚öïÔ∏è</span>
            <span class="text-xl font-bold"
              >Diabetes<span class="text-cyan-300">Care</span></span
            >
          </a>
          <div class="hidden md:flex items-center gap-6">
            <a href="/" class="hover:text-cyan-300 transition font-medium"
              >{{ _('Home') }}</a
            >
            <a href="/index" class="text-cyan-300 font-bold"
              >{{ _('Prediction') }}</a
            >
            <a href="/life" class="hover:text-cyan-300 transition font-medium"
              >{{ _('Lifestyle') }}</a
            >
            <a
              href="/chatbot"
              class="hover:text-cyan-300 transition font-medium"
              >{{ _('Chatbot') }}</a
            >
            <a
              href="/explore"
              class="hover:text-cyan-300 transition font-medium"
              >{{ _('Explore') }}</a
            >
            <a href="/forum" class="hover:text-cyan-300 transition font-medium"
              >{{ _('Forum') }}</a
            >
          </div>
          <div class="flex items-center gap-3">
            <button
              onclick="toggleTheme()"
              class="theme-toggle p-2 rounded-lg hover:bg-white/10 transition"
              aria-label="Toggle dark mode"
            >
              <svg
                id="theme-icon-sun"
                class="w-5 h-5 hidden"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
                />
              </svg>
              <svg
                id="theme-icon-moon"
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <!-- Hero Section -->
    <section
      class="bg-gradient-to-br from-blue-600 via-indigo-600 to-cyan-500 dark:from-slate-800 dark:via-slate-900 dark:to-slate-800 py-12"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <div class="fade-in">
          <div
            class="inline-flex items-center justify-center w-16 h-16 bg-white/20 rounded-2xl mb-4"
          >
            <svg
              class="w-8 h-8 text-white"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"
              />
            </svg>
          </div>
          <h1 class="text-3xl md:text-4xl font-bold text-white mb-3">
            {{ _('Diabetes Prediction') }}
          </h1>
          <p class="text-blue-100 text-lg max-w-2xl mx-auto">
            {{ _('Enter your health metrics to get an AI-powered diabetes risk
            assessment') }}
          </p>
        </div>
      </div>
    </section>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
      <div class="grid lg:grid-cols-3 gap-8">
        <!-- Form Section -->
        <div class="lg:col-span-2">
          <div class="glass-card rounded-2xl shadow-xl overflow-hidden fade-in">
            <div
              class="bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-indigo-700 dark:to-purple-800 px-6 py-4"
            >
              <div class="flex items-center gap-3">
                <div
                  class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center"
                >
                  <svg
                    class="w-5 h-5 text-white"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                    />
                  </svg>
                </div>
                <div>
                  <h2 class="text-xl font-bold text-white">
                    {{ _('Health Metrics') }}
                  </h2>
                  <p class="text-blue-100 text-sm">
                    {{ _('Enter your values for prediction') }}
                  </p>
                </div>
              </div>
            </div>

            <form
              action="/predict"
              method="post"
              onsubmit="storeInputs()"
              class="p-6 bg-white dark:bg-slate-900"
            >
              <div class="grid md:grid-cols-2 gap-5">
                <!-- Pregnancies -->
                <div>
                  <label
                    for="Pregnancies"
                    class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"
                    >{{ _('Pregnancies') }}</label
                  >
                  <input
                    type="number"
                    id="Pregnancies"
                    name="Pregnancies"
                    placeholder="e.g., 2"
                    required
                    min="0"
                    class="input-field w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:border-blue-500 dark:focus:border-blue-400 outline-none transition text-gray-800 dark:text-white"
                  />
                </div>

                <!-- Glucose -->
                <div>
                  <label
                    for="Glucose"
                    class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"
                    >{{ _('Glucose Level') }}
                    <span class="text-xs text-gray-400">(mg/dL)</span></label
                  >
                  <input
                    type="number"
                    id="Glucose"
                    name="Glucose"
                    placeholder="e.g., 130"
                    required
                    min="0"
                    class="input-field w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:border-blue-500 dark:focus:border-blue-400 outline-none transition text-gray-800 dark:text-white"
                  />
                </div>

                <!-- Blood Pressure -->
                <div>
                  <label
                    for="BloodPressure"
                    class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"
                    >{{ _('Blood Pressure') }}
                    <span class="text-xs text-gray-400">(mm Hg)</span></label
                  >
                  <input
                    type="number"
                    id="BloodPressure"
                    name="BloodPressure"
                    placeholder="e.g., 70"
                    required
                    min="0"
                    class="input-field w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:border-blue-500 dark:focus:border-blue-400 outline-none transition text-gray-800 dark:text-white"
                  />
                </div>

                <!-- Skin Thickness -->
                <div>
                  <label
                    for="SkinThickness"
                    class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"
                    >{{ _('Skin Thickness') }}
                    <span class="text-xs text-gray-400">(mm)</span></label
                  >
                  <input
                    type="number"
                    id="SkinThickness"
                    name="SkinThickness"
                    placeholder="e.g., 32"
                    required
                    min="0"
                    class="input-field w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:border-blue-500 dark:focus:border-blue-400 outline-none transition text-gray-800 dark:text-white"
                  />
                </div>

  <link rel="icon" href="{{ url_for('static', filename='stethoscope.png') }}" type="image/png" />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config = { darkMode: "class" };</script>
  <script>
    (function() {
      var t = localStorage.getItem("theme");
      if (t === "dark" || (!t && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
        document.documentElement.classList.add("dark");
      }
    })();
  </script>
  <style>
    .glass-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
    }
    .dark .glass-card {
      background: rgba(30, 41, 59, 0.95);
    }

    .glass-card:hover {
      transform: translateY(-4px);
      border-color: #facc15;
      box-shadow:
        0 0 0 1px #facc15 inset,
        0 0 25px rgba(250, 204, 21, 0.45),
        0 12px 35px rgba(250, 204, 21, 0.35);
    }

    .dark .glass-card:hover {
      border-color: #fbbf24;
      box-shadow:
        0 0 0 1px #fbbf24 inset,
        0 0 30px rgba(251, 191, 36, 0.55),
        0 16px 45px rgba(251, 191, 36, 0.4);
    }

    
  .risk {
    font-weight: bold;
    margin-top: 1rem;
  }
  .green {
    color: #16a34a; /* Tailwind green-600 */
  }
  .orange {
    color: #ea580c; /* orange-600 */
  }
  .red {
    color: #dc2626; /* red-600 */
  }

  </style>
</head>
<body class="min-h-screen bg-gray-50 dark:bg-slate-950">

  <!-- Navbar -->
  <nav class="bg-gradient-to-r from-blue-600 to-indigo-700 dark:from-slate-800 dark:to-slate-900 text-white sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-6 h-16 flex justify-between items-center">
      <a href="/" class="font-bold text-xl">‚öïÔ∏è Diabetes<span class="text-cyan-300">Care</span></a>
      <div class="hidden md:flex gap-6">
        <a href="/" class="hover:text-cyan-300">{{ _('Home') }}</a>
        <a href="/index" class="text-cyan-300 font-bold">{{ _('Prediction') }}</a>
        <a href="/dashboard" class="hover:text-cyan-300">{{ _('Dashboard') }}</a>
        <a href="/life" class="hover:text-cyan-300">{{ _('Lifestyle') }}</a>
        <a href="/chatbot" class="hover:text-cyan-300">{{ _('Chatbot') }}</a>
        <a href="/explore" class="hover:text-cyan-300">{{ _('Explore') }}</a>
        <a href="/forum" class="hover:text-cyan-300">{{ _('Forum') }}</a>
      </div>
    </div>
  </div>
</nav>

<!-- HERO -->
<section class="bg-gradient-to-br from-blue-600 via-indigo-600 to-cyan-500 dark:from-slate-800 dark:to-slate-900 py-12 text-center text-white">
  <h1 class="text-4xl font-bold mb-3">{{ _('Diabetes Prediction') }}</h1>
  <p class="text-blue-100">
    {{ _('Enter your health metrics to get an AI-powered assessment') }}
  </p>
</section>

<!-- MAIN -->
<main class="max-w-6xl mx-auto px-4 py-10">
  <div class="grid lg:grid-cols-3 gap-8">

    <!-- FORM -->
    <div class="lg:col-span-2 glass-card rounded-2xl shadow-xl">
      <form action="/predict" method="post" class="p-6 grid md:grid-cols-2 gap-5">

        {% for f,l,p in [
          ('Pregnancies','Pregnancies','2'),
          ('Glucose','Glucose Level','130'),
          ('BloodPressure','Blood Pressure','70'),
          ('SkinThickness','Skin Thickness','32'),
          ('Insulin','Insulin Level','85'),
          ('BMI','BMI','28.5'),
          ('DiabetesPedigreeFunction','Diabetes Pedigree','0.45'),
          ('Age','Age','35')
        ] %}

        <div>
          <label class="block mb-2 font-semibold">{{ _(l) }}</label>
          <input
            name="{{ f }}"
            required
            placeholder="e.g. {{ p }}"
            class="w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 rounded-xl text-gray-800 dark:text-white"
          />
        </div>

        {% endfor %}

        <button
          type="submit"
          class="md:col-span-2 mt-4 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold rounded-xl"
        >
          {{ _('Get Prediction') }}
        </button>

      </form>
      {% if error %}
  <p style="color: red; font-weight: bold;">{{ error }}</p>
{% endif %}

{% if prediction_text %}
  <h2>{{ prediction_text }}</h2>
{% endif %}

{% if severity %}
    <p class="risk {{ color }}">
        Risk Level: {{ severity }}
    </p>
{% endif %}
      
      <!-- Print and Download Buttons -->
      <div class="mt-4 flex justify-center gap-4 no-print">
        <button onclick="printReport()" 
          class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-xl shadow-md transition-transform duration-300 hover:scale-105">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
          </svg>
          {{ _('Print Report') }}
        </button>
        <button onclick="downloadPDF()" 
          class="flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-xl shadow-md transition-transform duration-300 hover:scale-105">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          {{ _('Download PDF') }}
        </button>
      </div>

      <!-- Hidden Printable Report -->
      <div id="printableReport" class="hidden print:block absolute left-0 top-0 w-full bg-white p-8">
        <div class="max-w-2xl mx-auto">
          <h1 class="text-3xl font-bold text-blue-900 text-center mb-6">DIABETES PREDICTION REPORT</h1>
          <p class="text-gray-600 text-center mb-8" id="reportDate"></p>
          
          <div class="bg-blue-50 border-2 border-blue-400 rounded-xl p-6 mb-6">
            <h2 class="text-xl font-bold text-blue-800 mb-2">RESULT</h2>
            <p class="text-2xl font-bold" id="reportResult">{{ prediction_text }}</p>
          </div>
          
          <div class="bg-gray-50 border border-gray-300 rounded-xl p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">INPUT VALUES</h2>
            <ul class="space-y-2 text-gray-700" id="reportInputValues"></ul>
          </div>
          
          <div class="bg-yellow-50 border border-yellow-400 rounded-xl p-4 mt-6">
            <p class="text-sm text-yellow-800">
              <strong>DISCLAIMER:</strong> This prediction is for informational purposes only and should not be considered medical advice. Please consult a healthcare professional for proper diagnosis.
            </p>
          </div>
        </div>
      </div>


        <a href="/explore"
        class="mt-8 block mx-auto max-w-xl text-center bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-2xl py-4 shadow-md transition-transform duration-300 hover:scale-105 select-none">
        üìä {{ _('Explore Dataset') }}
      </a>
      <a href="/life"
        class="mt-8 block mx-auto max-w-xl text-center bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-2xl py-4 shadow-md transition-transform duration-300 hover:scale-105 select-none">
        üìä {{ _('CHECK YOUR LIFESTYLE') }}
      </a>
    </section>
  </main>

          <button type="submit" class="md:col-span-2 mt-4 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold rounded-xl transition">
            {{ _('Get Prediction') }}
          </button>
        </form>
      </div>

      <!-- Sidebar -->
      <div class="space-y-4">
        <div class="glass-card p-5 rounded-2xl shadow-lg">
          <h3 class="font-bold mb-3 text-gray-800 dark:text-white">{{ _('Quick Links') }}</h3>
          <a href="/dashboard" class="block p-3 rounded-xl bg-blue-50 dark:bg-slate-800 hover:bg-blue-100 dark:hover:bg-slate-700 mb-2 text-gray-800 dark:text-white transition">
            üìä {{ _('View Dashboard') }}
          </a>
          <a href="/life" class="block p-3 rounded-xl bg-cyan-50 dark:bg-slate-800 hover:bg-cyan-100 dark:hover:bg-slate-700 mb-2 text-gray-800 dark:text-white transition">
            üí™ {{ _('Lifestyle Check') }}
          </a>
          <a href="/explore" class="block p-3 rounded-xl bg-indigo-50 dark:bg-slate-800 hover:bg-indigo-100 dark:hover:bg-slate-700 text-gray-800 dark:text-white transition">
            üîç {{ _('Explore Data') }}
          </a>
        </div>
      </div>
    </div>
  </footer>
<!--Back to Top button with functionality-->
         <button class="scroll-to-top" id="scrollToTop" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>
        <script>
             function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        window.addEventListener('scroll', () => {
            const scrollBtn = document.getElementById('scrollToTop');
            if (window.pageYOffset > 300) {
                scrollBtn.classList.add('show');
            } else {
                scrollBtn.classList.remove('show');
            }
        });
        </script>

    {% if prediction_text %}
    <div class="mt-8 glass-card rounded-2xl p-6 text-center shadow-xl">
      <h2 class="text-xl font-bold mb-2 text-gray-800 dark:text-white">{{ _('Prediction Result') }}</h2>
      <p id="predictionResult" class="text-lg text-gray-700 dark:text-gray-300">{{ prediction_text }}</p>
      <a href="/dashboard" class="inline-block mt-4 px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition">
        {{ _('View History') }}
      </a>
    </div>
    {% endif %}
  </main>

  <script>
    document.getElementById('predictionForm').addEventListener('submit', function(e) {
      const inputs = {
        Pregnancies: document.getElementById('Pregnancies').value,
        Glucose: document.getElementById('Glucose').value,
        BloodPressure: document.getElementById('BloodPressure').value,
        SkinThickness: document.getElementById('SkinThickness').value,
        Insulin: document.getElementById('Insulin').value,
        BMI: document.getElementById('BMI').value,
        DiabetesPedigreeFunction: document.getElementById('DiabetesPedigreeFunction').value,
        Age: document.getElementById('Age').value
      };
      sessionStorage.setItem('lastPredictionInputs', JSON.stringify(inputs));
    });

    // Save prediction to history after page loads with result
    window.addEventListener('DOMContentLoaded', function() {
      const resultElement = document.getElementById('predictionResult');
      if (resultElement) {
        const resultText = resultElement.textContent.trim();
        const inputs = JSON.parse(sessionStorage.getItem('lastPredictionInputs') || '{}');
        
        if (Object.keys(inputs).length > 0) {
          const history = JSON.parse(localStorage.getItem('predictionHistory') || '[]');
          
          let result = 'Not Diabetic';
          if (resultText.includes('Diabetic') && !resultText.includes('Not')) {
            result = 'Diabetic';
          }
          
          history.push({
            date: new Date().toISOString(),
            result: result,
            inputs: inputs
          });
          
          localStorage.setItem('predictionHistory', JSON.stringify(history));
          sessionStorage.removeItem('lastPredictionInputs');
        }
      }
    });
  </script>

</body>
</html>
