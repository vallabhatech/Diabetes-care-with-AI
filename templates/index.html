<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ _('Diabetes Prediction') }} | {{ _('Diabetes Care') }}</title>
    <link
      rel="icon"
      href="{{ url_for('static', filename='stethoscope.png') }}"
      type="image/png"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = { darkMode: "class" };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script>
      (function () {
        var savedTheme = localStorage.getItem("theme");
        var prefersDark = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;
        if (savedTheme === "dark" || (!savedTheme && prefersDark)) {
          document.documentElement.classList.add("dark");
        }
      })();
    </script>
    <style>
      * {
        transition: background-color 0.3s ease, border-color 0.3s ease;
      }
      .glass-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }
      .dark .glass-card {
        background: rgba(30, 41, 59, 0.95);
        border: 1px solid rgba(148, 163, 184, 0.2);
      }
      .fade-in {
        animation: fadeIn 0.6s ease-out forwards;
        opacity: 0;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .theme-toggle:hover {
        transform: rotate(15deg) scale(1.1);
      }
      .input-field:focus {
        transform: scale(1.01);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
      }
      @media print {
        body > *:not(#printableReport) {
          display: none !important;
        }

        #printableReport {
          display: block !important;
          position: static !important;
          height: auto !important;
          min-height: auto !important;
          page-break-after: avoid !important;
        }

        html,
        body {
          height: auto !important;
          overflow: visible !important;
        }
      }
    </style>
  </head>

  <body
    class="min-h-screen bg-gray-50 dark:bg-slate-950 transition-colors duration-300"
  >
    <!-- Navbar -->
    <nav
      class="bg-gradient-to-r from-blue-600 to-indigo-700 dark:from-slate-800 dark:to-slate-900 text-white shadow-lg sticky top-0 z-50"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <a href="/" class="flex items-center gap-2">
            <span class="text-2xl">‚öïÔ∏è</span>
            <span class="text-xl font-bold"
              >Diabetes<span class="text-cyan-300">Care</span></span
            >
          </a>
          <div class="hidden md:flex items-center gap-6">
            <a href="/" class="hover:text-cyan-300 transition font-medium"
              >{{ _('Home') }}</a
            >
            <a href="/index" class="text-cyan-300 font-bold"
              >{{ _('Prediction') }}</a
            >
            <a href="/life" class="hover:text-cyan-300 transition font-medium"
              >{{ _('Lifestyle') }}</a
            >
            <a
              href="/chatbot"
              class="hover:text-cyan-300 transition font-medium"
              >{{ _('Chatbot') }}</a
            >
            <a
              href="/explore"
              class="hover:text-cyan-300 transition font-medium"
              >{{ _('Explore') }}</a
            >
            <a href="/forum" class="hover:text-cyan-300 transition font-medium"
              >{{ _('Forum') }}</a
            >
          </div>
          <div class="flex items-center gap-3">
            <button
              onclick="toggleTheme()"
              class="theme-toggle p-2 rounded-lg hover:bg-white/10 transition"
              aria-label="Toggle dark mode"
            >
              <svg
                id="theme-icon-sun"
                class="w-5 h-5 hidden"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
                />
              </svg>
              <svg
                id="theme-icon-moon"
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <!-- Hero Section -->
    <section
      class="bg-gradient-to-br from-blue-600 via-indigo-600 to-cyan-500 dark:from-slate-800 dark:via-slate-900 dark:to-slate-800 py-12"
    >
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <div class="fade-in">
          <div
            class="inline-flex items-center justify-center w-16 h-16 bg-white/20 rounded-2xl mb-4"
          >
            <svg
              class="w-8 h-8 text-white"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"
              />
            </svg>
          </div>
          <h1 class="text-3xl md:text-4xl font-bold text-white mb-3">
            {{ _('Diabetes Prediction') }}
          </h1>
          <p class="text-blue-100 text-lg max-w-2xl mx-auto">
            {{ _('Enter your health metrics to get an AI-powered diabetes risk
            assessment') }}
          </p>
        </div>
      </div>
    </section>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
      <div class="grid lg:grid-cols-3 gap-8">
        <!-- Form Section -->
        <div class="lg:col-span-2">
          <div class="glass-card rounded-2xl shadow-xl overflow-hidden fade-in">
            <div
              class="bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-indigo-700 dark:to-purple-800 px-6 py-4"
            >
              <div class="flex items-center gap-3">
                <div
                  class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center"
                >
                  <svg
                    class="w-5 h-5 text-white"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                    />
                  </svg>
                </div>
                <div>
                  <h2 class="text-xl font-bold text-white">
                    {{ _('Health Metrics') }}
                  </h2>
                  <p class="text-blue-100 text-sm">
                    {{ _('Enter your values for prediction') }}
                  </p>
                </div>
              </div>
            </div>

            <form
              action="/predict"
              method="post"
              onsubmit="storeInputs()"
              class="p-6 bg-white dark:bg-slate-900"
            >
              <div class="grid md:grid-cols-2 gap-5">
                <!-- Pregnancies -->
                <div>
                  <label
                    for="Pregnancies"
                    class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"
                    >{{ _('Pregnancies') }}</label
                  >
                  <input
                    type="number"
                    id="Pregnancies"
                    name="Pregnancies"
                    placeholder="e.g., 2"
                    required
                    min="0"
                    class="input-field w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:border-blue-500 dark:focus:border-blue-400 outline-none transition text-gray-800 dark:text-white"
                  />
                </div>

                <!-- Glucose -->
                <div>
                  <label
                    for="Glucose"
                    class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"
                    >{{ _('Glucose Level') }}
                    <span class="text-xs text-gray-400">(mg/dL)</span></label
                  >
                  <input
                    type="number"
                    id="Glucose"
                    name="Glucose"
                    placeholder="e.g., 130"
                    required
                    min="0"
                    class="input-field w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:border-blue-500 dark:focus:border-blue-400 outline-none transition text-gray-800 dark:text-white"
                  />
                </div>

                <!-- Blood Pressure -->
                <div>
                  <label
                    for="BloodPressure"
                    class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"
                    >{{ _('Blood Pressure') }}
                    <span class="text-xs text-gray-400">(mm Hg)</span></label
                  >
                  <input
                    type="number"
                    id="BloodPressure"
                    name="BloodPressure"
                    placeholder="e.g., 70"
                    required
                    min="0"
                    class="input-field w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:border-blue-500 dark:focus:border-blue-400 outline-none transition text-gray-800 dark:text-white"
                  />
                </div>

                <!-- Skin Thickness -->
                <div>
                  <label
                    for="SkinThickness"
                    class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"
                    >{{ _('Skin Thickness') }}
                    <span class="text-xs text-gray-400">(mm)</span></label
                  >
                  <input
                    type="number"
                    id="SkinThickness"
                    name="SkinThickness"
                    placeholder="e.g., 32"
                    required
                    min="0"
                    class="input-field w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:border-blue-500 dark:focus:border-blue-400 outline-none transition text-gray-800 dark:text-white"
                  />
                </div>

                <!-- Insulin -->
                <div>
                  <label
                    for="Insulin"
                    class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"
                    >{{ _('Insulin Level') }}
                    <span class="text-xs text-gray-400">(ŒºU/mL)</span></label
                  >
                  <input
                    type="number"
                    id="Insulin"
                    name="Insulin"
                    placeholder="e.g., 85"
                    required
                    min="0"
                    class="input-field w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:border-blue-500 dark:focus:border-blue-400 outline-none transition text-gray-800 dark:text-white"
                  />
                </div>

                <!-- BMI -->
                <div>
                  <label
                    for="BMI"
                    class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"
                    >{{ _('BMI') }}
                    <span class="text-xs text-gray-400">(kg/m¬≤)</span></label
                  >
                  <input
                    type="number"
                    step="0.1"
                    id="BMI"
                    name="BMI"
                    placeholder="e.g., 28.5"
                    required
                    min="0"
                    class="input-field w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:border-blue-500 dark:focus:border-blue-400 outline-none transition text-gray-800 dark:text-white"
                  />
                </div>

                <!-- Diabetes Pedigree Function -->
                <div>
                  <label
                    for="DiabetesPedigreeFunction"
                    class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"
                    >{{ _('Diabetes Pedigree') }}
                    <span class="text-xs text-gray-400">(0-2.5)</span></label
                  >
                  <input
                    type="number"
                    step="0.01"
                    id="DiabetesPedigreeFunction"
                    name="DiabetesPedigreeFunction"
                    placeholder="e.g., 0.45"
                    required
                    min="0"
                    class="input-field w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:border-blue-500 dark:focus:border-blue-400 outline-none transition text-gray-800 dark:text-white"
                  />
                </div>

                <!-- Age -->
                <div>
                  <label
                    for="Age"
                    class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"
                    >{{ _('Age') }}
                    <span class="text-xs text-gray-400"
                      >({{ _('years') }})</span
                    ></label
                  >
                  <input
                    type="number"
                    id="Age"
                    name="Age"
                    placeholder="e.g., 35"
                    required
                    min="0"
                    class="input-field w-full px-4 py-3 bg-gray-50 dark:bg-slate-800 border-2 border-gray-200 dark:border-slate-700 rounded-xl focus:border-blue-500 dark:focus:border-blue-400 outline-none transition text-gray-800 dark:text-white"
                  />
                </div>
              </div>

              <!-- Submit Button -->
              <button
                type="submit"
                class="w-full mt-6 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center gap-3"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"
                  />
                </svg>
                {{ _('Get Prediction') }}
              </button>
            </form>
          </div>

          <!-- Prediction Result -->
          {% if prediction_text %}
          <div
            id="predictionResult"
            class="mt-6 glass-card rounded-2xl shadow-xl overflow-hidden fade-in"
          >
            <div
              class="bg-gradient-to-r from-cyan-600 to-blue-600 dark:from-cyan-700 dark:to-blue-800 px-6 py-4"
            >
              <h3 class="text-xl font-bold text-white flex items-center gap-2">
                <svg
                  class="w-6 h-6"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                  />
                </svg>
                {{ _('Prediction Result') }}
              </h3>
            </div>
            <div class="p-6 bg-white dark:bg-slate-900">
              <p
                class="text-xl font-semibold text-center text-gray-800 dark:text-white mb-4"
              >
                {{ prediction_text }}
              </p>

              <!-- Action Buttons -->
              <div class="flex flex-wrap justify-center gap-3 no-print">
                <button
                  onclick="printReport()"
                  class="flex items-center gap-2 px-5 py-2.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 font-medium rounded-xl hover:bg-blue-200 dark:hover:bg-blue-900/50 transition"
                >
                  <svg
                    class="w-4 h-4"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"
                    />
                  </svg>
                  {{ _('Print') }}
                </button>
                <button
                  onclick="downloadPDF()"
                  class="flex items-center gap-2 px-5 py-2.5 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-400 font-medium rounded-xl hover:bg-indigo-200 dark:hover:bg-indigo-900/50 transition"
                >
                  <svg
                    class="w-4 h-4"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                    />
                  </svg>
                  {{ _('Download PDF') }}
                </button>
              </div>
            </div>
          </div>
          {% endif %}
        </div>

        <!-- Sidebar -->
        <div class="space-y-6">
          <!-- Info Card -->
          <div class="glass-card rounded-2xl p-5 shadow-lg fade-in">
            <div
              class="w-10 h-10 bg-blue-100 dark:bg-blue-900/50 rounded-xl flex items-center justify-center mb-3"
            >
              <svg
                class="w-5 h-5 text-blue-600 dark:text-blue-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                />
              </svg>
            </div>
            <h3 class="font-bold text-gray-800 dark:text-white mb-2">
              {{ _('About This Tool') }}
            </h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">
              {{ _('This AI model predicts diabetes risk based on the Pima
              Indians Diabetes Dataset. Results are for informational purposes
              only.') }}
            </p>
          </div>

          <!-- Tips Card -->
          <div class="glass-card rounded-2xl p-5 shadow-lg fade-in">
            <div
              class="w-10 h-10 bg-indigo-100 dark:bg-indigo-900/50 rounded-xl flex items-center justify-center mb-3"
            >
              <svg
                class="w-5 h-5 text-indigo-600 dark:text-indigo-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
                />
              </svg>
            </div>
            <h3 class="font-bold text-gray-800 dark:text-white mb-2">
              {{ _('Input Tips') }}
            </h3>
            <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
              <li>‚Ä¢ {{ _('Glucose: Fasting blood sugar') }}</li>
              <li>‚Ä¢ {{ _('BMI: Weight(kg) / Height(m)¬≤') }}</li>
              <li>‚Ä¢ {{ _('Pedigree: Family history score') }}</li>
            </ul>
          </div>

          <!-- Quick Links -->
          <div class="glass-card rounded-2xl p-5 shadow-lg fade-in">
            <h3 class="font-bold text-gray-800 dark:text-white mb-3">
              {{ _('Quick Links') }}
            </h3>
            <div class="space-y-2">
              <a
                href="/life"
                class="flex items-center gap-2 p-3 rounded-xl bg-cyan-50 dark:bg-slate-800 hover:bg-cyan-100 dark:hover:bg-slate-700 transition text-cyan-700 dark:text-cyan-400 text-sm font-medium"
              >
                <svg
                  class="w-4 h-4"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
                  />
                </svg>
                {{ _('Lifestyle Check') }}
              </a>
              <a
                href="/explore"
                class="flex items-center gap-2 p-3 rounded-xl bg-indigo-50 dark:bg-slate-800 hover:bg-indigo-100 dark:hover:bg-slate-700 transition text-indigo-700 dark:text-indigo-400 text-sm font-medium"
              >
                <svg
                  class="w-4 h-4"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"
                  />
                </svg>
                {{ _('Explore Data') }}
              </a>
              <a
                href="/chatbot"
                class="flex items-center gap-2 p-3 rounded-xl bg-blue-50 dark:bg-slate-800 hover:bg-blue-100 dark:hover:bg-slate-700 transition text-blue-700 dark:text-blue-400 text-sm font-medium"
              >
                <svg
                  class="w-4 h-4"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
                  />
                </svg>
                {{ _('AI Chatbot') }}
              </a>
            </div>
          </div>
        </div>

        <button type="submit"
          class="w-full bg-blue-700 hover:bg-blue-800 text-white font-extrabold rounded-2xl py-4 shadow-lg transition-transform duration-300 hover:scale-105 flex justify-center items-center gap-3 select-none">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"
            stroke-width="2" aria-hidden="true" focusable="false">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 20h9" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m0 0L8 12m4 8l4-8" />
          </svg>
          {{ _('Predict') }}
        </button>
      </form>

      {% if prediction_text %}
      <div id="predictionResult"
        class="mt-10 mx-auto max-w-xl bg-blue-100 bg-opacity-70 border border-blue-400 rounded-3xl p-8 text-blue-900 font-semibold text-center text-xl shadow-lg backdrop-blur-sm"
        role="alert">
        {{ prediction_text }}
      </div>
      
      <!-- Print, Download, and Email Buttons -->
      <div class="mt-4 flex flex-wrap justify-center gap-4 no-print"></div>
        <button onclick="printReport()" 
          class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-xl shadow-md transition-transform duration-300 hover:scale-105">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
          </svg>
          {{ _('Print Report') }}
        </button>
        <button onclick="downloadPDF()" 
          class="flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-xl shadow-md transition-transform duration-300 hover:scale-105">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          {{ _('Download PDF') }}
        </button>
        <button onclick="toggleEmailForm()" 
          class="flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-xl shadow-md transition-transform duration-300 hover:scale-105">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
          </svg>
          {{ _('Email Report') }}
        </button>
      </div>

      <!-- Email Form (Hidden by default) -->
      <div id="emailFormContainer" class="mt-4 mx-auto max-w-xl hidden no-print">
        <div class="bg-white border border-indigo-200 rounded-2xl p-6 shadow-lg">
          <h3 class="text-lg font-semibold text-indigo-800 mb-4 flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
            {{ _('Send Report via Email') }}
          </h3>
          <div class="flex gap-3">
            <input type="email" id="emailInput" placeholder="{{ _('Enter email address') }}"
              class="flex-1 rounded-xl border border-indigo-300 focus:border-indigo-600 focus:ring-4 focus:ring-indigo-200 px-4 py-3 text-gray-800 placeholder-gray-400 transition-shadow duration-300" />
            <button onclick="sendEmailReport()" id="sendEmailBtn"
              class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-xl shadow-md transition-all duration-300 hover:scale-105 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100">
              <span id="sendEmailText">{{ _('Send') }}</span>
              <svg id="sendEmailSpinner" class="hidden animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
            </button>
          </div>
          <p id="emailStatus" class="mt-3 text-sm hidden"></p>
        </div>
      </div>

          <!-- Disclaimer -->
          <div
            class="bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4"
          >
            <p class="text-xs text-amber-800 dark:text-amber-400">
              <strong>{{ _('Disclaimer:') }}</strong> {{ _('This tool is for
              educational purposes only. Always consult a healthcare
              professional for medical advice.') }}
            </p>
          </div>
        </div>
      </div>
    </main>

    <!-- Hidden Printable Report -->
    <div
      id="printableReport"
      class="hidden print:block absolute left-0 top-0 w-full bg-white p-8"
    >
      <div class="max-w-2xl mx-auto">
        <h1 class="text-3xl font-bold text-blue-900 text-center mb-6">
          DIABETES PREDICTION REPORT
        </h1>
        <p class="text-gray-600 text-center mb-8" id="reportDate"></p>
        <div class="bg-blue-50 border-2 border-blue-400 rounded-xl p-6 mb-6">
          <h2 class="text-xl font-bold text-blue-800 mb-2">RESULT</h2>
          <p class="text-2xl font-bold" id="reportResult">
            {% if prediction_text %}{{ prediction_text }}{% endif %}
          </p>
        </div>
        <div class="bg-gray-50 border border-gray-300 rounded-xl p-6 mb-6">
          <h2 class="text-xl font-bold text-gray-800 mb-4">INPUT VALUES</h2>
          <ul class="space-y-2 text-gray-700" id="reportInputValues"></ul>
        </div>
        <div class="bg-yellow-50 border border-yellow-400 rounded-xl p-4 mt-6">
          <p class="text-sm text-yellow-800">
            <strong>DISCLAIMER:</strong> This prediction is for informational
            purposes only and should not be considered medical advice. Please
            consult a healthcare professional for proper diagnosis.
          </p>
        </div>
      </div>
      {% endif %}

        <a href="/explore"
        class="mt-8 block mx-auto max-w-xl text-center bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-2xl py-4 shadow-md transition-transform duration-300 hover:scale-105 select-none">
        üìä {{ _('Explore Dataset') }}
      </a>
      <a href="/life"
        class="mt-8 block mx-auto max-w-xl text-center bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-2xl py-4 shadow-md transition-transform duration-300 hover:scale-105 select-none">
        üìä {{ _('CHECK YOUR LIFESTYLE') }}
      </a>
    </section>
  </main>

    <!-- Chatbot FAB -->
    <a
      href="/chatbot"
      aria-label="Chatbot"
      title="Chatbot"
      class="fixed bottom-6 right-6 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg transition-all duration-300 hover:scale-110 z-50"
    >
      <svg
        class="w-7 h-7"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
        />
      </svg>
    </a>

    <!-- Footer -->
  <footer class="bg-slate-900 dark:bg-slate-950 text-white py-16">
    <div class="max-w-7xl mx-auto px-6">
      <div class="grid md:grid-cols-4 gap-12">
        <div>
          <h2 class="text-2xl font-bold mb-4">‚öïÔ∏è Diabetes<span class="text-cyan-400">Care</span></h2>
          <p class="text-slate-400">{{ _('Your AI-powered companion for smarter diabetes management.') }}</p>
        </div>
        <div>
          <h4 class="font-bold mb-4 text-slate-200">{{ _('Quick Links') }}</h4>
          <div class="space-y-2">
            <a href="/" class="block text-slate-400 hover:text-cyan-400 transition">{{ _('Home') }}</a>
            <a href="/index" class="block text-slate-400 hover:text-cyan-400 transition">{{ _('Prediction') }}</a>
            <a href="/life" class="block text-slate-400 hover:text-cyan-400 transition">{{ _('Lifestyle Check') }}</a>
            <a href="/chatbot" class="block text-slate-400 hover:text-cyan-400 transition">{{ _('Chatbot') }}</a>
            <a href="/forum" class="block text-slate-400 hover:text-cyan-400 transition">{{ _('Forum') }}</a>
          </div>
        </div>
        <div>
          <h4 class="font-bold mb-4 text-slate-200">{{ _('Resources') }}</h4>
          <div class="space-y-2">
            <a href="#" class="block text-slate-400 hover:text-cyan-400 transition">{{ _('About Us') }}</a>
            <a href="#" class="block text-slate-400 hover:text-cyan-400 transition">{{ _('Contact') }}</a>
            <a href="#" class="block text-slate-400 hover:text-cyan-400 transition">{{ _('Privacy Policy') }}</a>
            <a href="#" class="block text-slate-400 hover:text-cyan-400 transition">{{ _('Terms & Conditions') }}</a>
          </div>
        </div>
        <div>
          <h4 class="font-bold mb-4 text-slate-200">{{ _('Connect') }}</h4>
          <div class="flex gap-4">
            <a href="#" class="w-10 h-10 bg-slate-800 hover:bg-cyan-500 rounded-lg flex items-center justify-center transition">
              <i class="fab fa-github"></i>
            </a>
            <a href="#" class="w-10 h-10 bg-slate-800 hover:bg-cyan-500 rounded-lg flex items-center justify-center transition">
              <i class="fab fa-twitter"></i>
            </a>
            <a href="#" class="w-10 h-10 bg-slate-800 hover:bg-cyan-500 rounded-lg flex items-center justify-center transition">
              <i class="fab fa-linkedin"></i>
            </a>
          </div>
        </div>
      </div>
      <div class="border-t border-slate-800 mt-12 pt-8 text-center text-slate-500">
        ¬© {{ current_year }} {{ _('Diabetes Care Platform. All rights reserved.') }}
      </div>
    </div>
  </footer>

    <script>
      // Dark mode
      function toggleTheme() {
        var isDark = document.documentElement.classList.toggle("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
        updateThemeIcons();
      }
      function updateThemeIcons() {
        var isDark = document.documentElement.classList.contains("dark");
        document
          .getElementById("theme-icon-sun")
          .classList.toggle("hidden", !isDark);
        document
          .getElementById("theme-icon-moon")
          .classList.toggle("hidden", isDark);
      }
      document.addEventListener("DOMContentLoaded", updateThemeIcons);

      // Print and PDF functions
      function getInputValues() {
        return {
          Pregnancies: document.getElementById("Pregnancies")?.value || "N/A",
          "Glucose Level": document.getElementById("Glucose")?.value || "N/A",
          "Blood Pressure":
            document.getElementById("BloodPressure")?.value || "N/A",
          "Skin Thickness":
            document.getElementById("SkinThickness")?.value || "N/A",
          "Insulin Level": document.getElementById("Insulin")?.value || "N/A",
          BMI: document.getElementById("BMI")?.value || "N/A",
          "Diabetes Pedigree":
            document.getElementById("DiabetesPedigreeFunction")?.value || "N/A",
          Age: document.getElementById("Age")?.value || "N/A",
        };
      }
      function formatDate() {
        return new Date().toLocaleString("en-US", {
          year: "numeric",
          month: "long",
          day: "numeric",
          hour: "2-digit",
          minute: "2-digit",
        });
      }
      function storeInputs() {
        const values = getInputValues();
        sessionStorage.setItem("reportInputs", JSON.stringify(values));
      }

      function prepareReport() {
        var reportDate = document.getElementById("reportDate");
        var reportInputValues = document.getElementById("reportInputValues");
        if (reportDate) reportDate.textContent = "Date: " + formatDate();
        if (reportInputValues) {
          const values = JSON.parse(
            sessionStorage.getItem("reportInputs") || "{}"
          );

          reportInputValues.innerHTML = Object.entries(values)
            .map(function (entry) {
              return (
                "<li><strong>" + entry[0] + ":</strong> " + entry[1] + "</li>"
              );
            })
            .join("");
        }
        sessionStorage.removeItem("reportInputs");
      }

      function printReport() {
        prepareReport();
        var printableReport = document.getElementById("printableReport");
        if (printableReport) {
          printableReport.classList.remove("hidden");
          window.print();
          setTimeout(function () {
            printableReport.classList.add("hidden");
          }, 100);
        }
      }
      function downloadPDF() {
        prepareReport();
        var printableReport = document.getElementById("printableReport");
        if (printableReport && typeof html2pdf !== "undefined") {
          printableReport.classList.remove("hidden");
          const opt = {
            margin: 5,
            filename: "diabetes-prediction-report.pdf",
            image: { type: "jpeg", quality: 0.95 },
            html2canvas: { scale: 1.5, scrollY: 0 },
            jsPDF: { unit: "mm", format: "a4", orientation: "portrait" },
          };

          html2pdf()
            .set({
              margin: 5,
              html2canvas: { scale: 1.2 },
              jsPDF: { unit: "mm", format: "a4" },
            })
            .from(document.getElementById("printableReport"))
            .save();
        } else {
          alert("PDF generation is not available.");
        }
      }
    

    // Email Report Functions
    function toggleEmailForm() {
      const container = document.getElementById('emailFormContainer');
      if (container) {
        container.classList.toggle('hidden');
        if (!container.classList.contains('hidden')) {
          document.getElementById('emailInput').focus();
        }
      }
    }

    function setEmailLoading(loading) {
      const btn = document.getElementById('sendEmailBtn');
      const text = document.getElementById('sendEmailText');
      const spinner = document.getElementById('sendEmailSpinner');
      
      if (btn && text && spinner) {
        btn.disabled = loading;
        text.textContent = loading ? '{{ _("Sending...") }}' : '{{ _("Send") }}';
        spinner.classList.toggle('hidden', !loading);
      }
    }

    function showEmailStatus(message, isError) {
      const status = document.getElementById('emailStatus');
      if (status) {
        status.textContent = message;
        status.className = 'mt-3 text-sm ' + (isError ? 'text-red-600' : 'text-green-600');
        status.classList.remove('hidden');
        
        // Auto-hide success messages
        if (!isError) {
          setTimeout(() => {
            status.classList.add('hidden');
            document.getElementById('emailFormContainer').classList.add('hidden');
          }, 3000);
        }
      }
    }

    async function sendEmailReport() {
      const emailInput = document.getElementById('emailInput');
      const email = emailInput ? emailInput.value.trim() : '';
      
      if (!email) {
        showEmailStatus('{{ _("Please enter an email address") }}', true);
        return;
      }
      
      // Basic email validation
      if (!email.includes('@') || !email.includes('.')) {
        showEmailStatus('{{ _("Please enter a valid email address") }}', true);
        return;
      }
      
      const predictionResult = document.getElementById('predictionResult');
      if (!predictionResult) {
        showEmailStatus('{{ _("No prediction result to send") }}', true);
        return;
      }
      
      setEmailLoading(true);
      
      try {
        const response = await fetch('/api/send-prediction-email', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            email: email,
            prediction: predictionResult.textContent.trim(),
            inputValues: getInputValues()
          })
        });
        
        const data = await response.json();
        
        if (response.ok && data.success) {
          showEmailStatus('{{ _("Report sent successfully!") }}', false);
          emailInput.value = '';
        } else {
          showEmailStatus(data.error || '{{ _("Failed to send email") }}', true);
        }
      } catch (error) {
        console.error('Email send error:', error);
        showEmailStatus('{{ _("Failed to send email. Please try again.") }}', true);
      } finally {
        setEmailLoading(false);
      }
    }

    // Allow Enter key to send email
    document.addEventListener('DOMContentLoaded', function() {
      const emailInput = document.getElementById('emailInput');
      if (emailInput) {
        emailInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            e.preventDefault();
            sendEmailReport();
          }
        });
      }
    });
  </script>
</body>
</html>
""
